## 如何构建训练集和测试集

- 留出法：将数据集D划分位两个互斥的集合，一个集合作为训练集S，另一个座位测试集T
- 交叉验证法：将数据集划分为`k`个大小相似的互斥子集，$D = D_1 \cup D_2 \cup ... \cup D_k, D_i \cap D_j = \varnothing$，每个子集$D_i$都尽可能保持数据分布的一致性。每次用$k-1$个子集的并集作为训练集，余下的那个子集作为测试集，这样可以获得`k`组训练/测试集，从而可进行`k`次寻来拿和测试，最终返回的是这`k`个测试结果的均值。`k`的最常用取值是`10`，称之为`10`折交叉验证。
- 自助法：对数据集$D$进行采样产生数据集$D'$：每次随机从$D$中挑选一个样本，将其拷贝放入$D'$，再将其放回初始数据集$D$中，使得该样本在下次采样时仍有可能被采到；这个过程重复执行$m$次后就得到了包含$m$个样本的数据集$D'$。当$m$趋近于无穷时，样本在$m$次猜忌中始终不被采到的概率是$0.368$

## 性能度量

性能度量：衡量模型泛化能力的评价标准

![](https://ddf-typora-pics.oss-cn-shanghai.aliyuncs.com/picGo202312221103731.png)

### 查准率、查全率

针对二分类问题：

- TP：true positive，真正例
- FP：false positive，假正例
- TN：true negative，真反例
- FN：false negative，假反例

查准率：P，预测真例中有多少是真实的真例

查全率：R：真实真例中有多少被预测出来了
$$
P = \frac {TP} {TP + FP}
$$

$$
R = \frac {TP} {TP + FN}
$$

- PR曲线：查准率（P）为纵轴，查全率（R）为横轴做出的曲线图
  - 一个学习器的PR曲线被另一个学习器的曲线包住，则后者的性能优于前者
  - PR曲线如果有交叉
    - PR曲线下的面积大小（不容易估算）
    - 平衡点（BEP）：P = R时的取值，大者比较优
    - $F_1$度量：$F_1 = \frac {2 \times P \times R} {P + R} = \frac {2 \times TP} {样例总数 + TP - TN}$
    - 对查准率/查全率大不同偏好：$F_\beta = \frac {(1+\beta^2) \times P \times R} {\beta^2 \times P} + R$，$\beta > 1$时更偏向查全率，$\beta < 1$时更偏向查准率

### ROC和AUC

- 真正例率TPR：就是查全率：真正 / 所有真实正例
- 假正例率FPR：假正 / 所有真实反例

$$
TPR = \frac {TP} {TP + FN}
$$

$$
FPR = \frac {FP} {TN + FP}
$$

- ROC曲线：纵轴真正率，横轴假正率
  - A包住了B，则A优于B
  - 交叉：看AUC
- AUC：ROC曲线下面积

## 线性模型

$$
f(x) = w_1x_1 + w_2x_2 + ... + w_dx_d + b
$$

向量形式可以写成
$$
f(x) = w^Tx + b
$$


- 最小二乘法：试图找到一条直线，使所有样本到直线上的欧式距离（均方误差）之和最小

![](https://ddf-typora-pics.oss-cn-shanghai.aliyuncs.com/picGo202312221413434.png)

- 线性判别分析（LDA，Fisher判别分析）：给定训练样例集，将样例投影到一套直线上，使得同类样例的投影点尽可能接近、异类样例的投影点尽可能远离。

![](https://ddf-typora-pics.oss-cn-shanghai.aliyuncs.com/picGo202312221427917.png)

### 多分类学习

- 一对一（OvO）：有N个类别，将这N个类别两两配对，产生$\frac {N(N-1)} {2}$个二分类任务。在测试阶段，将新样本同时提交给所有分类器，得到$\frac {N(N-1)} {2}$个分类结果，把预测得最多的了诶别作为最终分类结果。
- 一对其余（OvR）：将一个类的样例作为正例、其他类的样例作为反例，训练N个分类器。测试时若仅有一个分类器预测为正类，则标记为最终分类结果。

![](https://ddf-typora-pics.oss-cn-shanghai.aliyuncs.com/picGo202312221433531.png)

- 多对多（MvM）：每次将若干类作为正类、若干类作为反类
  - 如何设计正、反类：纠错输出码（ECOC）
    - 编码：先对N个类别做M次划分，形成一个二分类训练集，共产生了M个训练集，训练出M个分类器
    - 解码：M个分类器分别对测试样本预测，结果组成一个编码，将这个编码和每个类别各自的编码比较，返回距离最小的类别

### 类别不平衡问题

分类任务中不同类别的训练样例数目差别很大。

![](https://ddf-typora-pics.oss-cn-shanghai.aliyuncs.com/picGo202312221443843.png)

## 决策树







